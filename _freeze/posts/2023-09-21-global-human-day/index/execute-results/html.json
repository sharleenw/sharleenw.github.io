{
  "hash": "4533352612607bd7826afa494fbc161b",
  "result": {
    "markdown": "---\ntitle: 'The Global Human Day Analysis'\nauthor: Sharleen Weatherley\ndate: '2023-09-21'\ndescription: Visualizing how different countries spend their days.\ncategories: [tidytuesday, eda, visualization]\nimage: \"image.jpg\"\nimage-alt: \"Earth from outer space (Source: Public Domain Files)\"\nexecute:\n  echo: true\n  warning: false\n  cache: true\n---\n\n::: {.cell hash='index_cache/html/setup_716d57c7075fcfb70bbe4b8c5f577096'}\n\n:::\n\n\n\n# Setup\n\nFirst I will call the necessary packages and read in the data, found at the [`tidytuesday` Github repository](https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-09-12/readme.md).\n\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-1_e69806f28e53125b714370c32c449097'}\n\n```{.r .cell-code}\n# Load packages\nlibrary(dplyr)\nlibrary(janitor)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(forcats)\nlibrary(knitr)\n\n# Reading the data in\nall_countries <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-09-12/all_countries.csv') |> \n  clean_names()\n\ncountry_regions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-09-12/country_regions.csv') |> \n  clean_names()\n\n# Set graph theme\ntheme_set(theme_minimal())\n```\n:::\n\n\n\n# Initial thoughts\n\nLooking at the data in the two data frames, my first thoughts are that I will join them together so that I can get `country_name` into the `all_countries` data set.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-2_89c939c09c4e5379ebc16fd0b9dcc47b'}\n\n```{.r .cell-code}\nall_countries |> \n  head(5) |>\n  kable()\n```\n\n::: {.cell-output-display}\n|category          |subcategory              |country_iso3 |region_code | population| hours_per_day_combined| uncertainty_combined|\n|:-----------------|:------------------------|:------------|:-----------|----------:|----------------------:|--------------------:|\n|Food provision    |Food preparation         |ABW          |AM_C        |     101665|                   1.47|            0.2376303|\n|Food provision    |Food growth & collection |ABW          |AM_C        |     101665|                   0.17|            0.0268798|\n|Food provision    |Food processing          |ABW          |AM_C        |     101665|                   0.00|            0.0075265|\n|Nonfood provision |Materials                |ABW          |AM_C        |     101665|                   0.03|            0.0020716|\n|Nonfood provision |Energy                   |ABW          |AM_C        |     101665|                   0.05|            0.0035968|\n:::\n\n```{.r .cell-code}\ncountry_regions |> \n  head(5) |> \n  kable()\n```\n\n::: {.cell-output-display}\n|region_code |region_name     |country_name | m49_code|country_iso2 |country_iso3 |alt_country_name |alt_country_name1                       |alt_country_name2 |alt_country_name3 |alt_country_name4 |alt_country_name5 |alt_country_name6 |other_code1 |other_code2 |\n|:-----------|:---------------|:------------|--------:|:------------|:------------|:----------------|:---------------------------------------|:-----------------|:-----------------|:-----------------|:-----------------|:-----------------|:-----------|:-----------|\n|AF_N        |Northern Africa |Algeria      |       12|DZ           |DZA          |Algeria          |People’s Democratic Republic of Algeria |NA                |NA                |NA                |NA                |NA                |NA          |NA          |\n|AF_N        |Northern Africa |Egypt        |      818|EG           |EGY          |Egypt            |Arab Republic of Egypt                  |NA                |NA                |NA                |NA                |NA                |NA          |NA          |\n|AF_N        |Northern Africa |Libya        |      434|LY           |LBY          |Libya            |State of Libya                          |NA                |NA                |NA                |NA                |NA                |NA          |NA          |\n|AF_N        |Northern Africa |Morocco      |      504|MA           |MAR          |Morocco          |Kingdom of Morocco                      |NA                |NA                |NA                |NA                |NA                |NA          |NA          |\n|AF_N        |Northern Africa |Sudan        |      729|SD           |SDN          |Sudan            |Republic of the Sudan                   |The Sudan         |NA                |NA                |NA                |NA                |NA          |NA          |\n:::\n:::\n\n\nI also want to peek at the different options for categories and subcategories:\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-3_32d7536a1a18e42c16cbe1e8b13455bd'}\n\n```{.r .cell-code}\nall_countries |> \n  distinct(category, subcategory) |> \n  arrange_all() |> \n  kable()\n```\n\n::: {.cell-output-display}\n|category                        |subcategory              |\n|:-------------------------------|:------------------------|\n|Deliberate neural restructuring |Religious practice       |\n|Deliberate neural restructuring |Schooling & research     |\n|Experience oriented             |Active recreation        |\n|Experience oriented             |Interactive              |\n|Experience oriented             |Meals                    |\n|Experience oriented             |Passive                  |\n|Experience oriented             |Social                   |\n|Food provision                  |Food growth & collection |\n|Food provision                  |Food preparation         |\n|Food provision                  |Food processing          |\n|Maintenance of surroundings     |Inhabited environment    |\n|Maintenance of surroundings     |Waste management         |\n|Nonfood provision               |Energy                   |\n|Nonfood provision               |Materials                |\n|Organization                    |Allocation               |\n|Organization                    |Human transportation     |\n|Organization                    |Material transportation  |\n|Somatic maintenance             |Health care              |\n|Somatic maintenance             |Hygiene & grooming       |\n|Somatic maintenance             |Physical child care      |\n|Somatic maintenance             |Sleep & bedrest          |\n|Technosphere modification       |Artifacts                |\n|Technosphere modification       |Buildings                |\n|Technosphere modification       |Infrastructure           |\n:::\n:::\n\n\n# Joining the two data sets\n\nThe below `left_join` will add `country_name` to the `all_countries` data set. I'm also going to get rid of some variables I won't be needing and `arrange` the data set.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-4_2b176f6a48a4083ad5ace4acc6ad8733'}\n\n```{.r .cell-code}\nall_countries <- all_countries |>\n  left_join(\n    country_regions |>\n      select(country_iso3,\n             country_name),\n    by = \"country_iso3\") |> \n    select(country_name,\n         category,\n         subcategory,\n         hours_per_day_combined) |> \n  arrange(country_name,\n          category,\n          subcategory)\n\nall_countries |> \n  head(5) |> \n  kable()\n```\n\n::: {.cell-output-display}\n|country_name |category                        |subcategory          | hours_per_day_combined|\n|:------------|:-------------------------------|:--------------------|----------------------:|\n|Afghanistan  |Deliberate neural restructuring |Religious practice   |                   0.29|\n|Afghanistan  |Deliberate neural restructuring |Schooling & research |                   1.33|\n|Afghanistan  |Experience oriented             |Active recreation    |                   0.23|\n|Afghanistan  |Experience oriented             |Interactive          |                   0.62|\n|Afghanistan  |Experience oriented             |Meals                |                   1.62|\n:::\n:::\n\n\n\n# Add an hour variable for the `category`\n\nThe `hours_per_day_combined` variable goes with the `subcategory` variable. I am going to create an hour variable for the `category` variable.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-5_669c655b1d84787abf018f63ea57afdf'}\n\n```{.r .cell-code}\nall_countries <- all_countries |> \n  rename(subcategory_hours_per_day = hours_per_day_combined) |> \n  group_by(country_name, category) |> \n  mutate(category_hours_per_day = sum(subcategory_hours_per_day),\n         .after = subcategory) |> \n  ungroup()\n\nall_countries |> \n  head(10) |> \n  kable()\n```\n\n::: {.cell-output-display}\n|country_name |category                        |subcategory              | category_hours_per_day| subcategory_hours_per_day|\n|:------------|:-------------------------------|:------------------------|----------------------:|-------------------------:|\n|Afghanistan  |Deliberate neural restructuring |Religious practice       |                   1.62|                      0.29|\n|Afghanistan  |Deliberate neural restructuring |Schooling & research     |                   1.62|                      1.33|\n|Afghanistan  |Experience oriented             |Active recreation        |                   6.32|                      0.23|\n|Afghanistan  |Experience oriented             |Interactive              |                   6.32|                      0.62|\n|Afghanistan  |Experience oriented             |Meals                    |                   6.32|                      1.62|\n|Afghanistan  |Experience oriented             |Passive                  |                   6.32|                      2.05|\n|Afghanistan  |Experience oriented             |Social                   |                   6.32|                      1.80|\n|Afghanistan  |Food provision                  |Food growth & collection |                   2.12|                      0.88|\n|Afghanistan  |Food provision                  |Food preparation         |                   2.12|                      1.14|\n|Afghanistan  |Food provision                  |Food processing          |                   2.12|                      0.10|\n:::\n:::\n\n\n\n# Visualize the two most different countries\n\nWhich two countries have the most different days? And how do they compare?\n\nModifying [this](https://stackoverflow.com/questions/67714078/how-to-get-the-pairwise-difference-of-all-values-within-uneven-categories-in-r) Stackoverflow topic, I am going to find the maximum pairwise difference between two countries and plot those two countries' days.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-6_e4df8c1f885abd11c71d3a5cd58ea0cf'}\n\n```{.r .cell-code}\ncountry_pair_diff <- all_countries |> \n  distinct(country_name,\n           category,\n           category_hours_per_day) |> \n  group_by(category) |> \n  reframe(result = combn(seq_along(category_hours_per_day), 2, function(i)\n    list(difference = diff(category_hours_per_day[i]),  #The difference\n         country_pair = paste0(country_name[i], collapse = '-')), # The pairs\n    simplify = FALSE)) |> \n  unnest_wider(result) |> \n  mutate(abs_difference = abs(difference)) |> \n  group_by(country_pair) |> \n  mutate(total_diff_country_pair = sum(abs_difference)) |> \n  ungroup()\n\ncountry_pair_diff |> \n  arrange(country_pair) |> \n  head(10) |> \n  kable()\n```\n\n::: {.cell-output-display}\n|category                        | difference|country_pair        | abs_difference| total_diff_country_pair|\n|:-------------------------------|----------:|:-------------------|--------------:|-----------------------:|\n|Deliberate neural restructuring |      -0.52|Afghanistan-Albania |           0.52|                    2.15|\n|Experience oriented             |       0.53|Afghanistan-Albania |           0.53|                    2.15|\n|Food provision                  |      -0.16|Afghanistan-Albania |           0.16|                    2.15|\n|Maintenance of surroundings     |       0.16|Afghanistan-Albania |           0.16|                    2.15|\n|Nonfood provision               |       0.03|Afghanistan-Albania |           0.03|                    2.15|\n|Organization                    |       0.09|Afghanistan-Albania |           0.09|                    2.15|\n|Somatic maintenance             |      -0.40|Afghanistan-Albania |           0.40|                    2.15|\n|Technosphere modification       |       0.26|Afghanistan-Albania |           0.26|                    2.15|\n|Deliberate neural restructuring |      -0.20|Afghanistan-Algeria |           0.20|                    2.46|\n|Experience oriented             |       1.07|Afghanistan-Algeria |           1.07|                    2.46|\n:::\n:::\n\n\n\nNow I can find the two most different countries. They will have the largest `total_diff_country_pair`.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-7_60114a83576a1b5859a3f31fcfbe3447'}\n\n```{.r .cell-code}\ncountry_pair_diff |> \n  distinct(country_pair,\n           total_diff_country_pair) |> \n  arrange(-total_diff_country_pair) |> \n  head(20) |> \n  kable()\n```\n\n::: {.cell-output-display}\n|country_pair                                 | total_diff_country_pair|\n|:--------------------------------------------|-----------------------:|\n|Democratic Republic of the Congo-Germany     |                    7.53|\n|Angola-Germany                               |                    7.42|\n|Cameroon-Germany                             |                    7.42|\n|Central African Republic-Germany             |                    7.42|\n|Chad-Germany                                 |                    7.42|\n|Equatorial Guinea-Germany                    |                    7.42|\n|Gabon-Germany                                |                    7.42|\n|Germany-Sao Tome and Principe                |                    7.42|\n|Bhutan-Germany                               |                    7.06|\n|Democratic Republic of the Congo-Japan       |                    6.97|\n|Democratic Republic of the Congo-Switzerland |                    6.95|\n|Democratic Republic of the Congo-Sweden      |                    6.91|\n|Democratic Republic of the Congo-Netherlands |                    6.89|\n|Angola-Japan                                 |                    6.86|\n|Cameroon-Japan                               |                    6.86|\n|Central African Republic-Japan               |                    6.86|\n|Chad-Japan                                   |                    6.86|\n|Equatorial Guinea-Japan                      |                    6.86|\n|Gabon-Japan                                  |                    6.86|\n|Japan-Sao Tome and Principe                  |                    6.86|\n:::\n:::\n\n\n# Graphing the two most different countries\n\nSo, with our knowledge now that the DRC and Germany have the most different days, let's plot the difference to see what it looks like:\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-8_de272dcd0e5cc5c32ac4ff609d4d2476'}\n\n```{.r .cell-code}\nall_countries |> \n  filter(country_name %in% c(\"Democratic Republic of the Congo\",\n                             \"Germany\")) |> \n  distinct(country_name, category, .keep_all = TRUE) |> \n  mutate(category = category |> \n           as.factor() |> \n           fct_reorder(category_hours_per_day)) |> \n  ggplot() +\n  geom_col(aes(x = category,\n               y = category_hours_per_day,\n               fill = country_name),\n           position = \"dodge2\") +\n  labs(x = \"Category\",\n       y = \"Hours per day\",\n       fill = \"Country name\") +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nIt looks like the DRC spends more time on `Deliberate neural restructuring`, which includes activities like religious practice and schooling and research, whereas Germany spends more time on `Experience oriented` activities, like active recreation, interactive, social, passive, and meals.\n\n\n<hr/>\n\n# Session info\n\n\n::: {.cell hash='index_cache/html/reproducibility_7eb079e325398804ee0163d2cc754e80'}\n::: {.cell-output .cell-output-stdout}\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.0 (2023-04-21 ucrt)\n os       Windows 11 x64 (build 22000)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  English_Canada.utf8\n ctype    English_Canada.utf8\n tz       Pacific/Honolulu\n date     2023-09-21\n pandoc   3.1.1 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n bit           4.0.5   2022-11-15 [1] CRAN (R 4.3.0)\n bit64         4.0.5   2020-08-30 [1] CRAN (R 4.3.0)\n cachem        1.0.8   2023-05-01 [1] CRAN (R 4.3.0)\n callr         3.7.3   2022-11-02 [1] CRAN (R 4.3.0)\n cli           3.6.1   2023-03-23 [1] CRAN (R 4.3.0)\n codetools     0.2-19  2023-02-01 [2] CRAN (R 4.3.0)\n colorspace    2.1-0   2023-01-23 [1] CRAN (R 4.3.0)\n crayon        1.5.2   2022-09-29 [1] CRAN (R 4.3.0)\n curl          5.0.0   2023-01-12 [1] CRAN (R 4.3.0)\n devtools    * 2.4.5   2022-10-11 [1] CRAN (R 4.3.1)\n digest        0.6.31  2022-12-11 [1] CRAN (R 4.3.0)\n dplyr       * 1.1.2   2023-04-20 [1] CRAN (R 4.3.0)\n ellipsis      0.3.2   2021-04-29 [1] CRAN (R 4.3.0)\n evaluate      0.20    2023-01-17 [1] CRAN (R 4.3.0)\n fansi         1.0.4   2023-01-22 [1] CRAN (R 4.3.0)\n farver        2.1.1   2022-07-06 [1] CRAN (R 4.3.0)\n fastmap       1.1.1   2023-02-24 [1] CRAN (R 4.3.0)\n forcats     * 1.0.0   2023-01-29 [1] CRAN (R 4.3.0)\n fs            1.6.2   2023-04-25 [1] CRAN (R 4.3.0)\n generics      0.1.3   2022-07-05 [1] CRAN (R 4.3.0)\n ggplot2     * 3.4.3   2023-08-14 [1] CRAN (R 4.3.1)\n glue          1.6.2   2022-02-24 [1] CRAN (R 4.3.0)\n gtable        0.3.3   2023-03-21 [1] CRAN (R 4.3.0)\n here        * 1.0.1   2020-12-13 [1] CRAN (R 4.3.0)\n hms           1.1.3   2023-03-21 [1] CRAN (R 4.3.0)\n htmltools     0.5.5   2023-03-23 [1] CRAN (R 4.3.0)\n htmlwidgets   1.6.2   2023-03-17 [1] CRAN (R 4.3.0)\n httpuv        1.6.11  2023-05-11 [1] CRAN (R 4.3.1)\n janitor     * 2.2.0   2023-02-02 [1] CRAN (R 4.3.0)\n jsonlite      1.8.4   2022-12-06 [1] CRAN (R 4.3.0)\n knitr       * 1.42    2023-01-25 [1] CRAN (R 4.3.0)\n labeling      0.4.2   2020-10-20 [1] CRAN (R 4.3.0)\n later         1.3.1   2023-05-02 [1] CRAN (R 4.3.0)\n lifecycle     1.0.3   2022-10-07 [1] CRAN (R 4.3.0)\n lubridate     1.9.2   2023-02-10 [1] CRAN (R 4.3.0)\n magrittr      2.0.3   2022-03-30 [1] CRAN (R 4.3.0)\n memoise       2.0.1   2021-11-26 [1] CRAN (R 4.3.0)\n mime          0.12    2021-09-28 [1] CRAN (R 4.3.0)\n miniUI        0.1.1.1 2018-05-18 [1] CRAN (R 4.3.0)\n munsell       0.5.0   2018-06-12 [1] CRAN (R 4.3.0)\n pillar        1.9.0   2023-03-22 [1] CRAN (R 4.3.0)\n pkgbuild      1.4.0   2022-11-27 [1] CRAN (R 4.3.0)\n pkgconfig     2.0.3   2019-09-22 [1] CRAN (R 4.3.0)\n pkgload       1.3.2   2022-11-16 [1] CRAN (R 4.3.0)\n prettyunits   1.1.1   2020-01-24 [1] CRAN (R 4.3.0)\n processx      3.8.1   2023-04-18 [1] CRAN (R 4.3.0)\n profvis       0.3.8   2023-05-02 [1] CRAN (R 4.3.0)\n promises      1.2.0.1 2021-02-11 [1] CRAN (R 4.3.0)\n ps            1.7.5   2023-04-18 [1] CRAN (R 4.3.0)\n purrr         1.0.1   2023-01-10 [1] CRAN (R 4.3.0)\n R6            2.5.1   2021-08-19 [1] CRAN (R 4.3.0)\n Rcpp          1.0.10  2023-01-22 [1] CRAN (R 4.3.0)\n readr         2.1.4   2023-02-10 [1] CRAN (R 4.3.0)\n remotes       2.4.2   2021-11-30 [1] CRAN (R 4.3.0)\n rlang         1.1.1   2023-04-28 [1] CRAN (R 4.3.0)\n rmarkdown     2.21    2023-03-26 [1] CRAN (R 4.3.0)\n rprojroot     2.0.3   2022-04-02 [1] CRAN (R 4.3.0)\n rstudioapi    0.15.0  2023-07-07 [1] CRAN (R 4.3.1)\n scales        1.2.1   2022-08-20 [1] CRAN (R 4.3.1)\n sessioninfo   1.2.2   2021-12-06 [1] CRAN (R 4.3.0)\n shiny         1.7.4   2022-12-15 [1] CRAN (R 4.3.0)\n snakecase     0.11.0  2019-05-25 [1] CRAN (R 4.3.0)\n stringi       1.7.12  2023-01-11 [1] CRAN (R 4.3.0)\n stringr       1.5.0   2022-12-02 [1] CRAN (R 4.3.0)\n tibble        3.2.1   2023-03-20 [1] CRAN (R 4.3.0)\n tidyr       * 1.3.0   2023-01-24 [1] CRAN (R 4.3.0)\n tidyselect    1.2.0   2022-10-10 [1] CRAN (R 4.3.0)\n timechange    0.2.0   2023-01-11 [1] CRAN (R 4.3.0)\n tzdb          0.3.0   2022-03-28 [1] CRAN (R 4.3.0)\n urlchecker    1.0.1   2021-11-30 [1] CRAN (R 4.3.0)\n usethis     * 2.2.2   2023-07-06 [1] CRAN (R 4.3.1)\n utf8          1.2.3   2023-01-31 [1] CRAN (R 4.3.0)\n vctrs         0.6.2   2023-04-19 [1] CRAN (R 4.3.0)\n vroom         1.6.3   2023-04-28 [1] CRAN (R 4.3.0)\n withr         2.5.0   2022-03-03 [1] CRAN (R 4.3.0)\n xfun          0.39    2023-04-20 [1] CRAN (R 4.3.0)\n xtable        1.8-4   2019-04-21 [1] CRAN (R 4.3.0)\n yaml          2.3.7   2023-01-23 [1] CRAN (R 4.3.0)\n\n [1] C:/Users/sharl/AppData/Local/R/win-library/4.3\n [2] C:/Program Files/R/R-4.3.0/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}